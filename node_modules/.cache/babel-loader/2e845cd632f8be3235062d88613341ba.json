{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Documents/GitHub/deepfake-demo/src/page/no-scroll.js\",\n  _s2 = $RefreshSig$();\nimport studio from '@theatre/studio';\nimport { getProject, val } from '@theatre/core';\nimport { useState, useEffect, useRef } from 'react';\nimport styled from 'styled-components';\nimport TheatreElements from '../components/theatre-elements';\nimport { useInView } from 'react-intersection-observer';\n\n// import { getProject, types } from '@theatre/core';\nimport projectState from '../json/state.json';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst defaultViewportHeight = '100vh';\nconst ViewBox = styled.div`\n  position: relative;\n  width: 100%;\n  height: 3000px;\n  min-height: 100vh;\n  outline: 3px solid blue;\n`;\n_c = ViewBox;\nconst TheatreContainer = styled.div`\n  width: 100%;\n  height: 100vh;\n  outline: 1px solid red;\n\n  position: sticky;\n  top: 0;\n  left: 0;\n`;\n\n// 下面參考 scrollable-video ---------------------------------\n\n//代表滑到這個框框的最上方\n_c2 = TheatreContainer;\nconst PositionStarter = styled.div`\n  width: 0;\n  height: 0;\n  opacity: 0;\n`;\n_c3 = PositionStarter;\nconst PositionFinisher = styled.div`\n  width: 0;\n  height: 0;\n  opacity: 0;\n`;\n_c4 = PositionFinisher;\nconst Other = styled.div`\n  width: 100%;\n  height: 100vh;\n`;\n_c5 = Other;\nconst Test = styled.div`\n  width: 25px;\n  height: 25px;\n  outline: 1px solid red;\n  position: sticky;\n  top: 0;\n  left: 0;\n  background: red;\n`;\nexport default function ScrollDemo() {\n  _s2();\n  var _s = $RefreshSig$();\n  studio.initialize();\n  const project = getProject('deepfake demo', {\n    state: projectState\n  });\n  const sheet = project.sheet('Scene', 'default');\n  studio.ui.hide();\n  project.ready.then(() => sheet.sequence.pause);\n  const sequenceLength = val(sheet.sequence.pointer.length);\n\n  // --------------------------------------------------------\n\n  // const theaterRef = useRef(null);\n\n  const testRef = useRef(null);\n  const [scrollPosition, setScrollPosition] = useState(0);\n  console.log('scrollPosition', scrollPosition);\n\n  // useEffect(() => {\n  //   const handleScroll = () => {\n  //     const testElement = testRef.current;\n  //     const viewboxElement = testElement.closest('.ViewBox');\n\n  //     const testRect = testElement.getBoundingClientRect();\n  //     const viewboxRect = viewboxElement.getBoundingClientRect();\n\n  //     const distance = testRect.top - viewboxRect.top;\n  //     setScrollPosition(distance);\n  //   };\n\n  //   window.addEventListener('scroll', handleScroll);\n\n  //   return () => {\n  //     window.removeEventListener('scroll', handleScroll);\n  //   };\n  // }, []);\n\n  // useEffect(() => {\n  //   // 3000 等同於 ScrollHeight 元件的高度\n  //   const newPosition = (scrollPosition / 3000) * sequenceLength;\n  //   sheet.sequence.position = newPosition;\n  // }, [scrollPosition]);\n\n  const positionStarterRef = useRef(null);\n  const positionFinisherRef = useRef(null);\n  const [isPositionStarterInView, setPositionStarterInView] = useState(false);\n  const [isPositionFinisherInView, setPositionFinisherInView] = useState(false);\n  const handleScroll = () => {\n    const testElement = testRef.current;\n    const viewboxElement = testElement.closest('.ViewBox');\n    const testRect = testElement.getBoundingClientRect();\n    const viewboxRect = viewboxElement.getBoundingClientRect();\n    const distance = testRect.top - viewboxRect.top;\n    setScrollPosition(distance);\n  };\n  useEffect(_s(() => {\n    _s();\n    const {\n      ref: positionStarterRef,\n      inView: isPositionStarterInView\n    } = useInView();\n    const {\n      ref: positionFinisherRef,\n      inView: isPositionFinisherInView\n    } = useInView();\n    setPositionStarterInView(isPositionStarterInView);\n    setPositionFinisherInView(isPositionFinisherInView);\n    if (isPositionStarterInView) {\n      window.addEventListener('scroll', handleScroll);\n    } else {\n      window.removeEventListener('scroll', handleScroll);\n    }\n    return () => {\n      window.removeEventListener('scroll', handleScroll);\n    };\n  }, \"3IiKWZp9c3AVQ3Jdxu65dnn9Mec=\", false, function () {\n    return [useInView, useInView];\n  }), []);\n  useEffect(() => {\n    const newPosition = scrollPosition / 3000 * sequenceLength;\n    sheet.sequence.position = newPosition;\n  }, [scrollPosition]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Other, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(PositionStarter, {\n      ref: positionStarterRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ViewBox, {\n      className: \"ViewBox\",\n      children: /*#__PURE__*/_jsxDEV(TheatreContainer, {\n        id: \"theatre-container\",\n        ref: testRef,\n        children: /*#__PURE__*/_jsxDEV(TheatreElements, {\n          sheet: sheet\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(PositionFinisher, {\n      ref: positionFinisherRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Other, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s2(ScrollDemo, \"8FBiNGwS1E0xn4aL9NMSagkppJI=\");\n_c6 = ScrollDemo;\nvar _c, _c2, _c3, _c4, _c5, _c6;\n$RefreshReg$(_c, \"ViewBox\");\n$RefreshReg$(_c2, \"TheatreContainer\");\n$RefreshReg$(_c3, \"PositionStarter\");\n$RefreshReg$(_c4, \"PositionFinisher\");\n$RefreshReg$(_c5, \"Other\");\n$RefreshReg$(_c6, \"ScrollDemo\");","map":{"version":3,"names":["studio","getProject","val","useState","useEffect","useRef","styled","TheatreElements","useInView","projectState","jsxDEV","_jsxDEV","Fragment","_Fragment","defaultViewportHeight","ViewBox","div","_c","TheatreContainer","_c2","PositionStarter","_c3","PositionFinisher","_c4","Other","_c5","Test","ScrollDemo","_s2","_s","$RefreshSig$","initialize","project","state","sheet","ui","hide","ready","then","sequence","pause","sequenceLength","pointer","length","testRef","scrollPosition","setScrollPosition","console","log","positionStarterRef","positionFinisherRef","isPositionStarterInView","setPositionStarterInView","isPositionFinisherInView","setPositionFinisherInView","handleScroll","testElement","current","viewboxElement","closest","testRect","getBoundingClientRect","viewboxRect","distance","top","ref","inView","window","addEventListener","removeEventListener","newPosition","position","children","fileName","_jsxFileName","lineNumber","columnNumber","className","id","_c6","$RefreshReg$"],"sources":["/Users/mac/Documents/GitHub/deepfake-demo/src/page/no-scroll.js"],"sourcesContent":["import studio from '@theatre/studio';\nimport { getProject, val } from '@theatre/core';\nimport { useState, useEffect, useRef } from 'react';\nimport styled from 'styled-components';\nimport TheatreElements from '../components/theatre-elements';\nimport { useInView } from 'react-intersection-observer';\n\n// import { getProject, types } from '@theatre/core';\nimport projectState from '../json/state.json';\n\nconst defaultViewportHeight = '100vh';\n\nconst ViewBox = styled.div`\n  position: relative;\n  width: 100%;\n  height: 3000px;\n  min-height: 100vh;\n  outline: 3px solid blue;\n`;\n\nconst TheatreContainer = styled.div`\n  width: 100%;\n  height: 100vh;\n  outline: 1px solid red;\n\n  position: sticky;\n  top: 0;\n  left: 0;\n`;\n\n// 下面參考 scrollable-video ---------------------------------\n\n//代表滑到這個框框的最上方\nconst PositionStarter = styled.div`\n  width: 0;\n  height: 0;\n  opacity: 0;\n`;\n\nconst PositionFinisher = styled.div`\n  width: 0;\n  height: 0;\n  opacity: 0;\n`;\n\nconst Other = styled.div`\n  width: 100%;\n  height: 100vh;\n`;\n\nconst Test = styled.div`\n  width: 25px;\n  height: 25px;\n  outline: 1px solid red;\n  position: sticky;\n  top: 0;\n  left: 0;\n  background: red;\n`;\n\nexport default function ScrollDemo() {\n  studio.initialize();\n  const project = getProject('deepfake demo', { state: projectState });\n  const sheet = project.sheet('Scene', 'default');\n\n  studio.ui.hide();\n  project.ready.then(() => sheet.sequence.pause);\n\n  const sequenceLength = val(sheet.sequence.pointer.length);\n\n  // --------------------------------------------------------\n\n  // const theaterRef = useRef(null);\n\n  const testRef = useRef(null);\n  const [scrollPosition, setScrollPosition] = useState(0);\n\n  console.log('scrollPosition', scrollPosition);\n\n  // useEffect(() => {\n  //   const handleScroll = () => {\n  //     const testElement = testRef.current;\n  //     const viewboxElement = testElement.closest('.ViewBox');\n\n  //     const testRect = testElement.getBoundingClientRect();\n  //     const viewboxRect = viewboxElement.getBoundingClientRect();\n\n  //     const distance = testRect.top - viewboxRect.top;\n  //     setScrollPosition(distance);\n  //   };\n\n  //   window.addEventListener('scroll', handleScroll);\n\n  //   return () => {\n  //     window.removeEventListener('scroll', handleScroll);\n  //   };\n  // }, []);\n\n  // useEffect(() => {\n  //   // 3000 等同於 ScrollHeight 元件的高度\n  //   const newPosition = (scrollPosition / 3000) * sequenceLength;\n  //   sheet.sequence.position = newPosition;\n  // }, [scrollPosition]);\n\n  const positionStarterRef = useRef(null);\n  const positionFinisherRef = useRef(null);\n\n  const [isPositionStarterInView, setPositionStarterInView] = useState(false);\n  const [isPositionFinisherInView, setPositionFinisherInView] = useState(false);\n\n  const handleScroll = () => {\n    const testElement = testRef.current;\n    const viewboxElement = testElement.closest('.ViewBox');\n\n    const testRect = testElement.getBoundingClientRect();\n    const viewboxRect = viewboxElement.getBoundingClientRect();\n\n    const distance = testRect.top - viewboxRect.top;\n    setScrollPosition(distance);\n  };\n\n  useEffect(() => {\n    const { ref: positionStarterRef, inView: isPositionStarterInView } =\n      useInView();\n    const { ref: positionFinisherRef, inView: isPositionFinisherInView } =\n      useInView();\n\n    setPositionStarterInView(isPositionStarterInView);\n    setPositionFinisherInView(isPositionFinisherInView);\n\n    if (isPositionStarterInView) {\n      window.addEventListener('scroll', handleScroll);\n    } else {\n      window.removeEventListener('scroll', handleScroll);\n    }\n\n    return () => {\n      window.removeEventListener('scroll', handleScroll);\n    };\n  }, []);\n\n  useEffect(() => {\n    const newPosition = (scrollPosition / 3000) * sequenceLength;\n    sheet.sequence.position = newPosition;\n  }, [scrollPosition]);\n\n  return (\n    <>\n      <Other />\n      <PositionStarter ref={positionStarterRef} />\n      <ViewBox className='ViewBox'>\n        <TheatreContainer id='theatre-container' ref={testRef}>\n          <TheatreElements sheet={sheet} />\n        </TheatreContainer>\n      </ViewBox>\n      <PositionFinisher ref={positionFinisherRef} />\n      <Other />\n    </>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}