{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Documents/GitHub/deepfake-demo/src/page/demo-scroll.js\",\n  _s = $RefreshSig$();\nimport { val } from '@theatre/core';\nimport { useState, useEffect, useRef } from 'react';\nimport styled from 'styled-components';\nimport TheatreElements from '../components/theatre-elements';\n// import { useInView } from 'react-intersection-observer';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ViewBox = styled.div`\n  position: relative;\n  width: 100%;\n  min-height: 100vh;\n`;\n_c = ViewBox;\nconst TheatreContainer = styled.div`\n  width: 100%;\n  height: 100vh;\n  position: sticky;\n  top: 0;\n  left: 0;\n`;\n\n// 下面參考 scrollable-video ---------------------------------\n\n//代表滑到這個框框的最上方\n_c2 = TheatreContainer;\nconst PositionStarter = styled.div`\n  width: 0;\n  height: 0;\n  opacity: 0;\n`;\nconst PositionFinisher = styled.div`\n  width: 0;\n  height: 0;\n  opacity: 0;\n`;\nconst Other = styled.div`\n  width: 100%;\n  height: 100vh;\n`;\nconst Test = styled.div`\n  width: 25px;\n  height: 25px;\n  outline: 1px solid red;\n  position: sticky;\n  top: 0;\n  left: 0;\n  background: red;\n`;\nexport default function DemoScroll(_ref) {\n  _s();\n  let {\n    project,\n    sheet\n  } = _ref;\n  project.ready.then(() => sheet.sequence.pause());\n  const sequenceLength = val(sheet.sequence.pointer.length); //總長度\n\n  const testRef = useRef(null);\n  const [scrollPosition, setScrollPosition] = useState(0);\n\n  // TODO: 增加條件，減少 event-listener 偵測時間\n\n  useEffect(() => {\n    const handleScroll = () => {\n      const testElement = testRef.current;\n      const viewboxElement = testElement.closest('.ViewBox');\n      const testRect = testElement.getBoundingClientRect();\n      const viewboxRect = viewboxElement.getBoundingClientRect();\n      const distance = testRect.top - viewboxRect.top;\n      setScrollPosition(distance);\n    };\n    window.addEventListener('scroll', handleScroll);\n    return () => {\n      window.removeEventListener('scroll', handleScroll);\n    };\n  }, []);\n  useEffect(() => {\n    const newPosition = scrollPosition / (sequenceLength * 1500) * sequenceLength;\n    sheet.sequence.position = newPosition;\n  }, [scrollPosition]);\n\n  // ----- 上面這段是絕對可用的，勿動 --------------------------------\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(ViewBox, {\n      className: \"ViewBox\",\n      style: {\n        height: `${sequenceLength * 1500}px`\n      },\n      children: /*#__PURE__*/_jsxDEV(TheatreContainer, {\n        id: \"theatre-container\",\n        ref: testRef,\n        children: /*#__PURE__*/_jsxDEV(TheatreElements, {\n          sheet: sheet\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n}\n_s(DemoScroll, \"XPpvNWNlgO6zkG9XjpaGJN6t8PU=\");\n_c3 = DemoScroll;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"ViewBox\");\n$RefreshReg$(_c2, \"TheatreContainer\");\n$RefreshReg$(_c3, \"DemoScroll\");","map":{"version":3,"names":["val","useState","useEffect","useRef","styled","TheatreElements","jsxDEV","_jsxDEV","Fragment","_Fragment","ViewBox","div","_c","TheatreContainer","_c2","PositionStarter","PositionFinisher","Other","Test","DemoScroll","_ref","_s","project","sheet","ready","then","sequence","pause","sequenceLength","pointer","length","testRef","scrollPosition","setScrollPosition","handleScroll","testElement","current","viewboxElement","closest","testRect","getBoundingClientRect","viewboxRect","distance","top","window","addEventListener","removeEventListener","newPosition","position","children","className","style","height","id","ref","fileName","_jsxFileName","lineNumber","columnNumber","_c3","$RefreshReg$"],"sources":["/Users/mac/Documents/GitHub/deepfake-demo/src/page/demo-scroll.js"],"sourcesContent":["import { val } from '@theatre/core';\nimport { useState, useEffect, useRef } from 'react';\nimport styled from 'styled-components';\nimport TheatreElements from '../components/theatre-elements';\n// import { useInView } from 'react-intersection-observer';\n\nconst ViewBox = styled.div`\n  position: relative;\n  width: 100%;\n  min-height: 100vh;\n`;\n\nconst TheatreContainer = styled.div`\n  width: 100%;\n  height: 100vh;\n  position: sticky;\n  top: 0;\n  left: 0;\n`;\n\n// 下面參考 scrollable-video ---------------------------------\n\n//代表滑到這個框框的最上方\nconst PositionStarter = styled.div`\n  width: 0;\n  height: 0;\n  opacity: 0;\n`;\n\nconst PositionFinisher = styled.div`\n  width: 0;\n  height: 0;\n  opacity: 0;\n`;\n\nconst Other = styled.div`\n  width: 100%;\n  height: 100vh;\n`;\n\nconst Test = styled.div`\n  width: 25px;\n  height: 25px;\n  outline: 1px solid red;\n  position: sticky;\n  top: 0;\n  left: 0;\n  background: red;\n`;\n\nexport default function DemoScroll({ project, sheet }) {\n  project.ready.then(() => sheet.sequence.pause());\n  const sequenceLength = val(sheet.sequence.pointer.length); //總長度\n\n  const testRef = useRef(null);\n  const [scrollPosition, setScrollPosition] = useState(0);\n\n  // TODO: 增加條件，減少 event-listener 偵測時間\n\n  useEffect(() => {\n    const handleScroll = () => {\n      const testElement = testRef.current;\n      const viewboxElement = testElement.closest('.ViewBox');\n\n      const testRect = testElement.getBoundingClientRect();\n      const viewboxRect = viewboxElement.getBoundingClientRect();\n\n      const distance = testRect.top - viewboxRect.top;\n      setScrollPosition(distance);\n    };\n\n    window.addEventListener('scroll', handleScroll);\n\n    return () => {\n      window.removeEventListener('scroll', handleScroll);\n    };\n  }, []);\n\n  useEffect(() => {\n    const newPosition =\n      (scrollPosition / (sequenceLength * 1500)) * sequenceLength;\n    sheet.sequence.position = newPosition;\n  }, [scrollPosition]);\n\n  // ----- 上面這段是絕對可用的，勿動 --------------------------------\n\n  return (\n    <>\n      <ViewBox\n        className='ViewBox'\n        style={{ height: `${sequenceLength * 1500}px` }}\n      >\n        <TheatreContainer id='theatre-container' ref={testRef}>\n          <TheatreElements sheet={sheet} />\n        </TheatreContainer>\n      </ViewBox>\n    </>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}