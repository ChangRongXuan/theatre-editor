{"ast":null,"code":"import _slicedToArray from\"/Users/mac/Documents/GitHub/deepfake-demo/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/Users/mac/Documents/GitHub/deepfake-demo/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2;import studio from'@theatre/studio';import{getProject,types}from'@theatre/core';import{useState,useEffect}from'react';import styled from'styled-components';import projectState from'../json/state.json';import{onChange,val}from'@theatre/core';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Container=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100vh;\\n  position: relative;\\n  outline: 5px solid red;\\n  z-index: -1;\\n  overflow: hidden;\\n\"])));var BasicBox=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  position: absolute;\\n  width: 300px;\\n  height: 20px;\\n  background: white;\\n  outline: 3px solid black;\\n  z-index: 10000;\\n  padding: 20px;\\n\"])));export default function Demo(){studio.initialize();var project=getProject('deepfake demo',{state:projectState});var sheet=project.sheet('Scene','default');studio.ui.hide();project.ready.then(function(){return sheet.sequence.play({iterationCount:1});});var _useState=useState([]),_useState2=_slicedToArray(_useState,2),preData=_useState2[0],setPreData=_useState2[1];//上一筆舊資料，要與 local-storage 一致\nconsole.log('preData',preData);//從 local-storage 取得舊資料\nuseEffect(function(){var storedBoxes=localStorage.getItem('theatre-data');if(storedBoxes){setPreData(JSON.parse(storedBoxes));}},[]);//render 出既有的元件\nuseEffect(function(){preData.filter(function(item){return item.type==='box';}).forEach(function(item){var box=sheet.object(item.id,{position:{x:0,y:0},bgColor:types.string('#ffffff')});var element=document.getElementById(item.id);box.onValuesChange(function(newValue){element.style.left=newValue.position.x+'px';element.style.top=newValue.position.y+'px';element.style.backgroundColor=newValue.bgColor;});});});// 總時間長度\nonChange(sheet.sequence.pointer.length,function(len){console.log('Length of the sequence changed to:',len);});// 目前時間位置\n// onChange(sheet.sequence.pointer.position, (position) => {\n//   console.log('Position of the sequence changed to:', position);\n// });\n// 目前狀態是 play 還是 pause\nonChange(sheet.sequence.pointer.playing,function(playing){console.log(playing?'playing':'paused');});//總時長\n// we can also read the current value of the pointer\nconsole.log('current length is',val(sheet.sequence.pointer.length));var totalSeconds=val(sheet.sequence.pointer.length);console.log('Total seconds:',totalSeconds);// console.log('sequence.pointer.length', sheet.sequence.pointer.length);\n// console.log('sequence.pointer.position', sheet.sequence.pointer.position);\n// console.log('sequence.pointer.playing', sheet.sequence.pointer.playing);\nreturn/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Container,{id:\"item-container\",children:preData.map(function(box,index){return/*#__PURE__*/_jsx(BasicBox,{id:box.id,style:box.style,children:box.content},index);})})});}","map":{"version":3,"names":["studio","getProject","types","useState","useEffect","styled","projectState","onChange","val","jsx","_jsx","Fragment","_Fragment","Container","div","_templateObject","_taggedTemplateLiteral","BasicBox","_templateObject2","Demo","initialize","project","state","sheet","ui","hide","ready","then","sequence","play","iterationCount","_useState","_useState2","_slicedToArray","preData","setPreData","console","log","storedBoxes","localStorage","getItem","JSON","parse","filter","item","type","forEach","box","object","id","position","x","y","bgColor","string","element","document","getElementById","onValuesChange","newValue","style","left","top","backgroundColor","pointer","length","len","playing","totalSeconds","children","map","index","content"],"sources":["/Users/mac/Documents/GitHub/deepfake-demo/src/page/demo.js"],"sourcesContent":["import studio from '@theatre/studio';\nimport { getProject, types } from '@theatre/core';\nimport { useState, useEffect } from 'react';\nimport styled from 'styled-components';\nimport projectState from '../json/state.json';\nimport { onChange, val } from '@theatre/core';\n\nconst Container = styled.div`\n  width: 100%;\n  height: 100vh;\n  position: relative;\n  outline: 5px solid red;\n  z-index: -1;\n  overflow: hidden;\n`;\n\nconst BasicBox = styled.div`\n  position: absolute;\n  width: 300px;\n  height: 20px;\n  background: white;\n  outline: 3px solid black;\n  z-index: 10000;\n  padding: 20px;\n`;\n\nexport default function Demo() {\n  studio.initialize();\n\n  const project = getProject('deepfake demo', { state: projectState });\n  const sheet = project.sheet('Scene', 'default');\n\n  studio.ui.hide();\n\n  project.ready.then(() =>\n    sheet.sequence.play({\n      iterationCount: 1,\n    })\n  );\n\n  const [preData, setPreData] = useState([]); //上一筆舊資料，要與 local-storage 一致\n\n  console.log('preData', preData);\n\n  //從 local-storage 取得舊資料\n  useEffect(() => {\n    const storedBoxes = localStorage.getItem('theatre-data');\n    if (storedBoxes) {\n      setPreData(JSON.parse(storedBoxes));\n    }\n  }, []);\n\n  //render 出既有的元件\n  useEffect(() => {\n    preData\n      .filter((item) => item.type === 'box')\n      .forEach((item) => {\n        const box = sheet.object(item.id, {\n          position: {\n            x: 0,\n            y: 0,\n          },\n          bgColor: types.string('#ffffff'),\n        });\n\n        const element = document.getElementById(item.id);\n\n        box.onValuesChange((newValue) => {\n          element.style.left = newValue.position.x + 'px';\n          element.style.top = newValue.position.y + 'px';\n          element.style.backgroundColor = newValue.bgColor;\n        });\n      });\n  });\n\n  // 總時間長度\n  onChange(sheet.sequence.pointer.length, (len) => {\n    console.log('Length of the sequence changed to:', len);\n  });\n\n  // 目前時間位置\n  // onChange(sheet.sequence.pointer.position, (position) => {\n  //   console.log('Position of the sequence changed to:', position);\n  // });\n\n  // 目前狀態是 play 還是 pause\n  onChange(sheet.sequence.pointer.playing, (playing) => {\n    console.log(playing ? 'playing' : 'paused');\n  });\n\n  //總時長\n  // we can also read the current value of the pointer\n  console.log('current length is', val(sheet.sequence.pointer.length));\n\n  const totalSeconds = val(sheet.sequence.pointer.length);\n  console.log('Total seconds:', totalSeconds);\n\n  // console.log('sequence.pointer.length', sheet.sequence.pointer.length);\n  // console.log('sequence.pointer.position', sheet.sequence.pointer.position);\n  // console.log('sequence.pointer.playing', sheet.sequence.pointer.playing);\n\n  return (\n    <>\n      <Container id='item-container'>\n        {preData.map((box, index) => (\n          <BasicBox key={index} id={box.id} style={box.style}>\n            {box.content}\n          </BasicBox>\n        ))}\n      </Container>\n    </>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}