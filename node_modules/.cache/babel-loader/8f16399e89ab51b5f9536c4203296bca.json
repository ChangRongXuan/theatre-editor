{"ast":null,"code":"import _objectSpread from\"/Users/mac/Documents/GitHub/deepfake-demo/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/mac/Documents/GitHub/deepfake-demo/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import studio from'@theatre/studio';import{types}from'@theatre/core';import{useState,useEffect}from'react';import Stage from'../components/stage';import{initialConfig}from'../constants';import ControlPanel from'../components/control-panel';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Playground(_ref){var project=_ref.project,sheet=_ref.sheet,setAnimateJSON=_ref.setAnimateJSON,animateJSON=_ref.animateJSON;studio.ui.restore();project.ready.then(function(){return sheet.sequence.pause();});var _useState=useState([]),_useState2=_slicedToArray(_useState,2),savedData=_useState2[0],setSavedData=_useState2[1];//取得儲存在 local-storage 裡的資料\n// get localStorage element data\nuseEffect(function(){var elements=localStorage.getItem('theatre-data');if(elements){setSavedData(JSON.parse(elements));}},[]);useEffect(function(){if(savedData.length>0){//render font control menu\nsavedData.filter(function(item){return item.type==='font';}).forEach(function(item){var menuConfig=sheet.object(item.id,_objectSpread(_objectSpread({},initialConfig.FONT),{},{content:types.string(\"\".concat(item.content))}));var element=document.getElementById(item.id);menuConfig.onValuesChange(function(newValue){element.style.left=newValue.position.x+'%';element.style.top=newValue.position.y+'%';element.style.background=newValue.bgColor;element.style.color=newValue.font.color;element.style.opacity=newValue.opacity;element.style.padding=newValue.padding+'px';element.style.display=newValue.visible?'block':'none';element.style.width=newValue.size.width+'px';element.style.height=newValue.size.height+'px';element.style.fontSize=newValue.font.size+'px';element.style.borderRadius=newValue.border.radius+'%';element.style.border=\"\".concat(newValue.border.size,\"px solid \").concat(newValue.border.color);});});savedData.filter(function(item){return item.type==='image';}).forEach(function(item){var menuConfig=sheet.object(item.id,_objectSpread(_objectSpread({},initialConfig.IMAGE),{},{url:types.string(\"\".concat(item.url))}));var element=document.getElementById(item.id);menuConfig.onValuesChange(function(newValue){element.style.left=newValue.position.x+'%';element.style.top=newValue.position.y+'%';element.style.opacity=newValue.opacity;element.style.display=newValue.visible?'block':'none';element.style.width=newValue.size.width+'px';element.style.height=newValue.size.height+'px';element.style.borderRadius=newValue.border.radius+'%';element.style.border=\"\".concat(newValue.border.size,\"px solid \").concat(newValue.border.color);element.style.backgroundImage=\"url(\".concat(newValue.url,\")\");});});}},[savedData]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ControlPanel,{sheet:sheet,setAnimateJSON:setAnimateJSON,animateJSON:animateJSON}),/*#__PURE__*/_jsx(Stage,{savedData:savedData,sheet:sheet})]});}","map":{"version":3,"names":["studio","types","useState","useEffect","Stage","initialConfig","ControlPanel","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Playground","_ref","project","sheet","setAnimateJSON","animateJSON","ui","restore","ready","then","sequence","pause","_useState","_useState2","_slicedToArray","savedData","setSavedData","elements","localStorage","getItem","JSON","parse","length","filter","item","type","forEach","menuConfig","object","id","_objectSpread","FONT","content","string","concat","element","document","getElementById","onValuesChange","newValue","style","left","position","x","top","y","background","bgColor","color","font","opacity","padding","display","visible","width","size","height","fontSize","borderRadius","border","radius","IMAGE","url","backgroundImage","children"],"sources":["/Users/mac/Documents/GitHub/deepfake-demo/src/page/playground.js"],"sourcesContent":["import studio from '@theatre/studio';\nimport { types } from '@theatre/core';\nimport { useState, useEffect } from 'react';\nimport Stage from '../components/stage';\nimport { initialConfig } from '../constants';\nimport ControlPanel from '../components/control-panel';\n\nexport default function Playground({\n  project,\n  sheet,\n  setAnimateJSON,\n  animateJSON,\n}) {\n  studio.ui.restore();\n  project.ready.then(() => sheet.sequence.pause());\n\n  const [savedData, setSavedData] = useState([]); //取得儲存在 local-storage 裡的資料\n\n  // get localStorage element data\n  useEffect(() => {\n    const elements = localStorage.getItem('theatre-data');\n    if (elements) {\n      setSavedData(JSON.parse(elements));\n    }\n  }, []);\n\n  useEffect(() => {\n    if (savedData.length > 0) {\n      //render font control menu\n      savedData\n        .filter((item) => item.type === 'font')\n        .forEach((item) => {\n          const menuConfig = sheet.object(item.id, {\n            ...initialConfig.FONT,\n            content: types.string(`${item.content}`),\n          });\n          const element = document.getElementById(item.id);\n\n          menuConfig.onValuesChange((newValue) => {\n            element.style.left = newValue.position.x + '%';\n            element.style.top = newValue.position.y + '%';\n            element.style.background = newValue.bgColor;\n            element.style.color = newValue.font.color;\n            element.style.opacity = newValue.opacity;\n            element.style.padding = newValue.padding + 'px';\n            element.style.display = newValue.visible ? 'block' : 'none';\n            element.style.width = newValue.size.width + 'px';\n            element.style.height = newValue.size.height + 'px';\n            element.style.fontSize = newValue.font.size + 'px';\n            element.style.borderRadius = newValue.border.radius + '%';\n            element.style.border = `${newValue.border.size}px solid ${newValue.border.color}`;\n          });\n        });\n\n      savedData\n        .filter((item) => item.type === 'image')\n        .forEach((item) => {\n          const menuConfig = sheet.object(item.id, {\n            ...initialConfig.IMAGE,\n            url: types.string(`${item.url}`),\n          });\n          const element = document.getElementById(item.id);\n\n          menuConfig.onValuesChange((newValue) => {\n            element.style.left = newValue.position.x + '%';\n            element.style.top = newValue.position.y + '%';\n            element.style.opacity = newValue.opacity;\n            element.style.display = newValue.visible ? 'block' : 'none';\n            element.style.width = newValue.size.width + 'px';\n            element.style.height = newValue.size.height + 'px';\n            element.style.borderRadius = newValue.border.radius + '%';\n            element.style.border = `${newValue.border.size}px solid ${newValue.border.color}`;\n            element.style.backgroundImage = `url(${newValue.url})`;\n          });\n        });\n    }\n  }, [savedData]);\n\n  return (\n    <>\n      <ControlPanel\n        sheet={sheet}\n        setAnimateJSON={setAnimateJSON}\n        animateJSON={animateJSON}\n      />\n      <Stage savedData={savedData} sheet={sheet} />\n    </>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}