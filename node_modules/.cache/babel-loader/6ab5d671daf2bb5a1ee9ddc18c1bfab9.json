{"ast":null,"code":"import _objectSpread from\"/Users/mac/Documents/GitHub/deepfake-demo/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/mac/Documents/GitHub/deepfake-demo/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/Users/mac/Documents/GitHub/deepfake-demo/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3;import{types}from'@theatre/core';import{useState,useEffect}from'react';import{initialConfig}from'../constants';import styled from'styled-components';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Wrapper=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100vh;\\n  position: relative;\\n\"])));var FontElement=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  position: absolute;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n\"])));var ImageElement=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  position: absolute;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  background-size: cover;\\n  background-repeat: no-repeat;\\n  background-position: center;\\n\"])));export default function DemoVideo(_ref){var project=_ref.project,sheet=_ref.sheet;project.ready.then(function(){return sheet.sequence.play({iterationCount:Infinity});});var _useState=useState([]),_useState2=_slicedToArray(_useState,2),storedData=_useState2[0],setStoredData=_useState2[1];// data in local-storage\nuseEffect(function(){var elements=localStorage.getItem('theatre-data');if(elements){setStoredData(JSON.parse(elements));}},[]);// 如何修改內容？？\nuseEffect(function(){if(storedData.length>0){//render `font` control menu\nstoredData.filter(function(item){return item.type==='font';}).forEach(function(item){var menuConfig=sheet.object(item.id,_objectSpread(_objectSpread({},initialConfig.FONT),{},{content:types.string(\"\".concat(item.content))}));var element=document.getElementById(item.id);menuConfig.onValuesChange(function(newValue){element.style.cssText=\"\\n              left: \".concat(newValue.position.x,\"%;\\n              top: \").concat(newValue.position.y,\"\\u4FEE\\u6539\\u310B\\u3128\\n              background: \").concat(newValue.bgColor,\";\\n              color: \").concat(newValue.font.color,\";\\n              opacity: \").concat(newValue.opacity,\";\\n              padding: \").concat(newValue.padding,\"px;\\n              display: \").concat(newValue.visible?'block':'none',\";\\n              width: \").concat(newValue.size.width,\"px;\\n              height: \").concat(newValue.size.height,\"px;\\n              font-size: \").concat(newValue.font.size,\"px;\\n              border-radius: \").concat(newValue.border.radius,\"%;\\n              border: \").concat(newValue.border.size,\"px solid \").concat(newValue.border.color,\";\\n            \");});});//render `image` control menu\nstoredData.filter(function(item){return item.type==='image';}).forEach(function(item){var menuConfig=sheet.object(item.id,_objectSpread(_objectSpread({},initialConfig.IMAGE),{},{url:types.string(\"\".concat(item.url))}));var element=document.getElementById(item.id);menuConfig.onValuesChange(function(newValue){element.style.cssText=\"\\n              left: \".concat(newValue.position.x,\"%;\\n              top: \").concat(newValue.position.y,\"%;\\n              width: \").concat(newValue.size.width,\"px;\\n              height: \").concat(newValue.size.height,\"px;\\n              border-radius: \").concat(newValue.border.radius,\"%;\\n              border: \").concat(newValue.border.size,\"px solid \").concat(newValue.border.color,\";\\n              background: \").concat(newValue.bgColor,\";\\n              opacity: \").concat(newValue.opacity,\";\\n              display: \").concat(newValue.visible?'block':'none',\";\\n              background-image = url(\").concat(newValue.url,\");\\n            \");});});}},[storedData]);var fontElements=storedData.filter(function(data){return data.type==='font';}).map(function(data,index){return/*#__PURE__*/_jsx(FontElement,{id:data.id,children:data.content},index);});var imageElements=storedData.filter(function(data){return data.type==='image';}).map(function(data,index){var style={backgroundImage:\"url(\".concat(data.url,\")\")};return/*#__PURE__*/_jsx(ImageElement,{id:data.id,style:style},index);});return/*#__PURE__*/_jsxs(Wrapper,{id:\"theatre-stage\",children:[fontElements,imageElements]});}","map":{"version":3,"names":["types","useState","useEffect","initialConfig","styled","jsx","_jsx","jsxs","_jsxs","Wrapper","div","_templateObject","_taggedTemplateLiteral","FontElement","_templateObject2","ImageElement","_templateObject3","DemoVideo","_ref","project","sheet","ready","then","sequence","play","iterationCount","Infinity","_useState","_useState2","_slicedToArray","storedData","setStoredData","elements","localStorage","getItem","JSON","parse","length","filter","item","type","forEach","menuConfig","object","id","_objectSpread","FONT","content","string","concat","element","document","getElementById","onValuesChange","newValue","style","cssText","position","x","y","bgColor","font","color","opacity","padding","visible","size","width","height","border","radius","IMAGE","url","fontElements","data","map","index","children","imageElements","backgroundImage"],"sources":["/Users/mac/Documents/GitHub/deepfake-demo/src/page/demo-video.js"],"sourcesContent":["import { types } from '@theatre/core';\nimport { useState, useEffect } from 'react';\nimport { initialConfig } from '../constants';\nimport styled from 'styled-components';\n\nconst Wrapper = styled.div`\n  width: 100%;\n  height: 100vh;\n  position: relative;\n`;\n\nconst FontElement = styled.div`\n  position: absolute;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst ImageElement = styled.div`\n  position: absolute;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-position: center;\n`;\n\nexport default function DemoVideo({ project, sheet }) {\n  project.ready.then(() =>\n    sheet.sequence.play({\n      iterationCount: Infinity,\n    })\n  );\n\n  const [storedData, setStoredData] = useState([]); // data in local-storage\n\n  useEffect(() => {\n    const elements = localStorage.getItem('theatre-data');\n    if (elements) {\n      setStoredData(JSON.parse(elements));\n    }\n  }, []);\n\n  // 如何修改內容？？\n  useEffect(() => {\n    if (storedData.length > 0) {\n      //render `font` control menu\n      storedData\n        .filter((item) => item.type === 'font')\n        .forEach((item) => {\n          const menuConfig = sheet.object(item.id, {\n            ...initialConfig.FONT,\n            content: types.string(`${item.content}`),\n          });\n\n          const element = document.getElementById(item.id);\n\n          menuConfig.onValuesChange((newValue) => {\n            element.style.cssText = `\n              left: ${newValue.position.x}%;\n              top: ${newValue.position.y}修改ㄋㄨ\n              background: ${newValue.bgColor};\n              color: ${newValue.font.color};\n              opacity: ${newValue.opacity};\n              padding: ${newValue.padding}px;\n              display: ${newValue.visible ? 'block' : 'none'};\n              width: ${newValue.size.width}px;\n              height: ${newValue.size.height}px;\n              font-size: ${newValue.font.size}px;\n              border-radius: ${newValue.border.radius}%;\n              border: ${newValue.border.size}px solid ${newValue.border.color};\n            `;\n          });\n        });\n\n      //render `image` control menu\n      storedData\n        .filter((item) => item.type === 'image')\n        .forEach((item) => {\n          const menuConfig = sheet.object(item.id, {\n            ...initialConfig.IMAGE,\n            url: types.string(`${item.url}`),\n          });\n\n          const element = document.getElementById(item.id);\n\n          menuConfig.onValuesChange((newValue) => {\n            element.style.cssText = `\n              left: ${newValue.position.x}%;\n              top: ${newValue.position.y}%;\n              width: ${newValue.size.width}px;\n              height: ${newValue.size.height}px;\n              border-radius: ${newValue.border.radius}%;\n              border: ${newValue.border.size}px solid ${newValue.border.color};\n              background: ${newValue.bgColor};\n              opacity: ${newValue.opacity};\n              display: ${newValue.visible ? 'block' : 'none'};\n              background-image = url(${newValue.url});\n            `;\n          });\n        });\n    }\n  }, [storedData]);\n\n  const fontElements = storedData\n    .filter((data) => data.type === 'font')\n    .map((data, index) => {\n      return (\n        <FontElement key={index} id={data.id}>\n          {data.content}\n        </FontElement>\n      );\n    });\n\n  const imageElements = storedData\n    .filter((data) => data.type === 'image')\n    .map((data, index) => {\n      const style = { backgroundImage: `url(${data.url})` };\n      return <ImageElement key={index} id={data.id} style={style} />;\n    });\n\n  return (\n    <Wrapper id='theatre-stage'>\n      {fontElements}\n      {imageElements}\n    </Wrapper>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}