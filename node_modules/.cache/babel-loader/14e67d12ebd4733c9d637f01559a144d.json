{"ast":null,"code":"import _slicedToArray from\"/Users/mac/Documents/GitHub/deepfake-demo/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import studio from'@theatre/studio';import{getProject}from'@theatre/core';import Stage from'../components/stage';import Dimmer from'../components/dimmer-with-message';import{useState,useEffect}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function DemoVideo(){studio.initialize();studio.ui.hide();var project=getProject('Project',{});var sheet=project.sheet('Scene','default');project.ready.then(function(){return sheet.sequence.play({iterationCount:Infinity});});var objJson=localStorage.getItem('theatre-data');// get objectJSON in local-storage\nvar objData=objJson?JSON.parse(objJson):[];// --------------------------\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),hasImgError=_useState2[0],setHasImgError=_useState2[1];// image & background onError\nvar _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),loadedImages=_useState4[0],setLoadedImages=_useState4[1];// image & background onload\nvar _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var totalImages=objData.filter(function(data){return data.type==='IMAGE'||data.type==='BACKGROUND';}).length;useEffect(function(){if(loadedImages===totalImages){setIsLoading(false);}},[loadedImages,totalImages]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Dimmer,{show:isLoading&&!hasImgError,message:'載入中',shining:true}),/*#__PURE__*/_jsx(Dimmer,{show:hasImgError,message:'載入失敗。請檢查您的網路連線，並重新整理瀏覽器。'}),/*#__PURE__*/_jsx(Stage,{objData:objData,sheet:sheet,stageWidth:window.innerWidth,draggable:false,setHasImgError:setHasImgError,setLoadedImages:setLoadedImages})]});}","map":{"version":3,"names":["studio","getProject","Stage","Dimmer","useState","useEffect","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","DemoVideo","initialize","ui","hide","project","sheet","ready","then","sequence","play","iterationCount","Infinity","objJson","localStorage","getItem","objData","JSON","parse","_useState","_useState2","_slicedToArray","hasImgError","setHasImgError","_useState3","_useState4","loadedImages","setLoadedImages","_useState5","_useState6","isLoading","setIsLoading","totalImages","filter","data","type","length","children","show","message","shining","stageWidth","window","innerWidth","draggable"],"sources":["/Users/mac/Documents/GitHub/deepfake-demo/src/page/demo-video.js"],"sourcesContent":["import studio from '@theatre/studio';\nimport { getProject } from '@theatre/core';\nimport Stage from '../components/stage';\nimport Dimmer from '../components/dimmer-with-message';\nimport { useState, useEffect } from 'react';\n\nexport default function DemoVideo() {\n  studio.initialize();\n  studio.ui.hide();\n  const project = getProject('Project', {});\n  const sheet = project.sheet('Scene', 'default');\n\n  project.ready.then(() =>\n    sheet.sequence.play({\n      iterationCount: Infinity,\n    })\n  );\n\n  const objJson = localStorage.getItem('theatre-data'); // get objectJSON in local-storage\n  const objData = objJson ? JSON.parse(objJson) : [];\n\n  // --------------------------\n\n  const [hasImgError, setHasImgError] = useState(false); // image & background onError\n  const [loadedImages, setLoadedImages] = useState(0); // image & background onload\n  const [isLoading, setIsLoading] = useState(true);\n\n  const totalImages = objData.filter(\n    (data) => data.type === 'IMAGE' || data.type === 'BACKGROUND'\n  ).length;\n\n  useEffect(() => {\n    if (loadedImages === totalImages) {\n      setIsLoading(false);\n    }\n  }, [loadedImages, totalImages]);\n\n  return (\n    <>\n      <Dimmer\n        show={isLoading && !hasImgError}\n        message={'載入中'}\n        shining={true}\n      />\n      <Dimmer\n        show={hasImgError}\n        message={'載入失敗。請檢查您的網路連線，並重新整理瀏覽器。'}\n      />\n      <Stage\n        objData={objData}\n        sheet={sheet}\n        stageWidth={window.innerWidth}\n        draggable={false}\n        setHasImgError={setHasImgError}\n        setLoadedImages={setLoadedImages}\n      />\n    </>\n  );\n}\n"],"mappings":"+HAAA,MAAO,CAAAA,MAAM,KAAM,iBAAiB,CACpC,OAASC,UAAU,KAAQ,eAAe,CAC1C,MAAO,CAAAC,KAAK,KAAM,qBAAqB,CACvC,MAAO,CAAAC,MAAM,KAAM,mCAAmC,CACtD,OAASC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,QAAA,IAAAC,SAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAE5C,cAAe,SAAS,CAAAC,SAASA,CAAA,CAAG,CAClCZ,MAAM,CAACa,UAAU,CAAC,CAAC,CACnBb,MAAM,CAACc,EAAE,CAACC,IAAI,CAAC,CAAC,CAChB,GAAM,CAAAC,OAAO,CAAGf,UAAU,CAAC,SAAS,CAAE,CAAC,CAAC,CAAC,CACzC,GAAM,CAAAgB,KAAK,CAAGD,OAAO,CAACC,KAAK,CAAC,OAAO,CAAE,SAAS,CAAC,CAE/CD,OAAO,CAACE,KAAK,CAACC,IAAI,CAAC,iBACjB,CAAAF,KAAK,CAACG,QAAQ,CAACC,IAAI,CAAC,CAClBC,cAAc,CAAEC,QAClB,CAAC,CAAC,EACJ,CAAC,CAED,GAAM,CAAAC,OAAO,CAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC,CAAE;AACtD,GAAM,CAAAC,OAAO,CAAGH,OAAO,CAAGI,IAAI,CAACC,KAAK,CAACL,OAAO,CAAC,CAAG,EAAE,CAElD;AAEA,IAAAM,SAAA,CAAsC1B,QAAQ,CAAC,KAAK,CAAC,CAAA2B,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA9CG,WAAW,CAAAF,UAAA,IAAEG,cAAc,CAAAH,UAAA,IAAqB;AACvD,IAAAI,UAAA,CAAwC/B,QAAQ,CAAC,CAAC,CAAC,CAAAgC,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAA5CE,YAAY,CAAAD,UAAA,IAAEE,eAAe,CAAAF,UAAA,IAAiB;AACrD,IAAAG,UAAA,CAAkCnC,QAAQ,CAAC,IAAI,CAAC,CAAAoC,UAAA,CAAAR,cAAA,CAAAO,UAAA,IAAzCE,SAAS,CAAAD,UAAA,IAAEE,YAAY,CAAAF,UAAA,IAE9B,GAAM,CAAAG,WAAW,CAAGhB,OAAO,CAACiB,MAAM,CAChC,SAACC,IAAI,QAAK,CAAAA,IAAI,CAACC,IAAI,GAAK,OAAO,EAAID,IAAI,CAACC,IAAI,GAAK,YAAY,EAC/D,CAAC,CAACC,MAAM,CAER1C,SAAS,CAAC,UAAM,CACd,GAAIgC,YAAY,GAAKM,WAAW,CAAE,CAChCD,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CAAC,CAAE,CAACL,YAAY,CAAEM,WAAW,CAAC,CAAC,CAE/B,mBACEhC,KAAA,CAAAF,SAAA,EAAAuC,QAAA,eACEzC,IAAA,CAACJ,MAAM,EACL8C,IAAI,CAAER,SAAS,EAAI,CAACR,WAAY,CAChCiB,OAAO,CAAE,KAAM,CACfC,OAAO,CAAE,IAAK,CACf,CAAC,cACF5C,IAAA,CAACJ,MAAM,EACL8C,IAAI,CAAEhB,WAAY,CAClBiB,OAAO,CAAE,0BAA2B,CACrC,CAAC,cACF3C,IAAA,CAACL,KAAK,EACJyB,OAAO,CAAEA,OAAQ,CACjBV,KAAK,CAAEA,KAAM,CACbmC,UAAU,CAAEC,MAAM,CAACC,UAAW,CAC9BC,SAAS,CAAE,KAAM,CACjBrB,cAAc,CAAEA,cAAe,CAC/BI,eAAe,CAAEA,eAAgB,CAClC,CAAC,EACF,CAAC,CAEP"},"metadata":{},"sourceType":"module"}