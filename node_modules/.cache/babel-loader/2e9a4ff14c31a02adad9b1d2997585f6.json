{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = Questionnaire;\nvar _question = _interopRequireDefault(require(\"./question\"));\nvar _questionCard = _interopRequireDefault(require(\"./question-card\"));\nvar _result = _interopRequireDefault(require(\"./result\"));\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _cloneDeep = _interopRequireDefault(require(\"lodash/cloneDeep\"));\nvar _difference = _interopRequireDefault(require(\"lodash/difference\"));\nvar _intersection = _interopRequireDefault(require(\"lodash/intersection\"));\nvar _landing = _interopRequireDefault(require(\"./landing\"));\nvar _defaultLayout = _interopRequireDefault(require(\"./layout/default-layout\"));\nvar _embeddedCode = require(\"./draft/embedded-code\");\nfunction _getRequireWildcardCache(nodeInterop) {\n  if (typeof WeakMap !== \"function\") return null;\n  var cacheBabelInterop = new WeakMap();\n  var cacheNodeInterop = new WeakMap();\n  return (_getRequireWildcardCache = function (nodeInterop) {\n    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n  })(nodeInterop);\n}\nfunction _interopRequireWildcard(obj, nodeInterop) {\n  if (!nodeInterop && obj && obj.__esModule) {\n    return obj;\n  }\n  if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n  var cache = _getRequireWildcardCache(nodeInterop);\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n  for (var key in obj) {\n    if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n  newObj.default = obj;\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n  return newObj;\n}\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nconst _ = {\n  cloneDeep: _cloneDeep.default,\n  difference: _difference.default,\n  intersection: _intersection.default\n};\n/**\n *  @param {Object} opts\n *  @param {import('./typedef').Form} opts.form\n *  @param {boolean} [opts.enableDebugViewer=false]\n *  @return {React.ReactElement}\n */\n\nfunction Questionnaire(_ref) {\n  let {\n    form,\n    enableDebugViewer = false\n  } = _ref;\n  var _userAnswers$currentQ;\n  if (!Array.isArray(form === null || form === void 0 ? void 0 : form.fields)) {\n    return /*#__PURE__*/_react.default.createElement(\"h3\", null, \"There is no question to answer\");\n  }\n  const copyForm = (0, _react.useMemo)(() => createFormData(form), [form]);\n  const emptyUserAnswers = (0, _react.useMemo)(() => createEmptyUserAnswers(copyForm.fields.length), [copyForm.fields.length]);\n  const [userAnswers, setUserAnswers] = (0, _react.useState)(emptyUserAnswers);\n  const [currentQuestion, setCurrentQuestion] = (0, _react.useState)(copyForm.fields[0]);\n  const [currentFormCondition, setCurrentFormCondition] = (0, _react.useState)(null);\n  let debugViewerJsx = null;\n  if (enableDebugViewer) {\n    debugViewerJsx = /*#__PURE__*/_react.default.createElement(\"div\", {\n      style: {\n        position: 'fixed',\n        right: '10px',\n        top: '30%',\n        height: '50vh',\n        overflow: 'scroll'\n      }\n    }, /*#__PURE__*/_react.default.createElement(\"pre\", {\n      id: \"json\"\n    }, currentFormCondition ? JSON.stringify(currentFormCondition, null, 4) : 'No form condition matched'));\n  } // The question has been answered\n\n  if (((_userAnswers$currentQ = userAnswers[currentQuestion.number]) === null || _userAnswers$currentQ === void 0 ? void 0 : _userAnswers$currentQ.length) > 0) {\n    const matchedFormCondition = matchConditions(userAnswers, copyForm.conditions);\n    if (matchedFormCondition) {\n      if (enableDebugViewer) {\n        if (matchedFormCondition.id !== (currentFormCondition === null || currentFormCondition === void 0 ? void 0 : currentFormCondition.id)) {\n          setCurrentFormCondition(matchedFormCondition);\n        }\n      }\n      const {\n        answer,\n        next,\n        goOut\n      } = matchedFormCondition;\n      if (answer) {\n        var _copyForm$answers;\n        return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, debugViewerJsx, /*#__PURE__*/_react.default.createElement(_result.default, {\n          resultData: (_copyForm$answers = copyForm.answers) === null || _copyForm$answers === void 0 ? void 0 : _copyForm$answers.find(a => a.id === answer.id)\n        }), /*#__PURE__*/_react.default.createElement(\"div\", {\n          style: {\n            marginTop: '60px'\n          }\n        }, /*#__PURE__*/_react.default.createElement(_embeddedCode.EmbeddedCodeBlock, {\n          getData: () => {\n            return {\n              caption: '',\n              embeddedCode: (form === null || form === void 0 ? void 0 : form.feedback) || ''\n            };\n          }\n        })));\n      }\n      if (goOut) {\n        // TODO: render GoOut component\n        return /*#__PURE__*/_react.default.createElement(\"div\", null, \"render goOut component\");\n      }\n      if (!next) {\n        // The program should not enter this condition.\n        // If it does, then the form data is created wrongly.\n        return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, debugViewerJsx, /*#__PURE__*/_react.default.createElement(_result.default, {\n          resultData: {\n            name: `Next question is not specified`\n          }\n        }));\n      }\n      const nextQ = copyForm.fields.find(q => q.id === next.id);\n      if (nextQ.id === currentQuestion.id) {\n        return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, debugViewerJsx, /*#__PURE__*/_react.default.createElement(_result.default, {\n          resultData: {\n            name: `Next question is not configured right. The next question name is ${nextQ.name}`\n          }\n        }));\n      } // Go to next queustion\n\n      setCurrentQuestion(nextQ);\n    } else {\n      return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, debugViewerJsx, /*#__PURE__*/_react.default.createElement(_result.default, {\n        resultData: {\n          name: 'There is no matched condition'\n        }\n      }));\n    }\n  }\n  return /*#__PURE__*/_react.default.createElement(_defaultLayout.default, null, debugViewerJsx, /*#__PURE__*/_react.default.createElement(_landing.default, {\n    form: form\n  }), /*#__PURE__*/_react.default.createElement(_questionCard.default, {\n    isFristPage: userAnswers[0].length === 0\n  }, /*#__PURE__*/_react.default.createElement(_question.default, _extends({\n    key: currentQuestion.id\n  }, currentQuestion, {\n    onAnswer:\n    /**\n     *  @param {string[]} a\n     */\n    a => {\n      const newUserAnswers = [...userAnswers];\n      newUserAnswers[currentQuestion.number] = a;\n      setUserAnswers(newUserAnswers);\n    }\n  }))));\n}\n/**\n *  The function compares the `condition` and `answer` objects.\n *  If `answer` matches `condition`, return true, otherwise, return false.\n *\n *  @param {string[]} answer\n *  @param {import('./typedef').Condition} condition\n *  @return {boolean}\n */\n\nfunction matchCondition(answer, condition) {\n  // no answer\n  if (answer.length === 0) {\n    return false;\n  }\n  switch (condition.compare) {\n    case 'not':\n      {\n        var _condition$option;\n\n        // Check if there is no any answer to match any option\n        return _.intersection(answer, condition === null || condition === void 0 ? void 0 : (_condition$option = condition.option) === null || _condition$option === void 0 ? void 0 : _condition$option.map(o => o.value)).length === 0;\n      }\n    case 'include':\n      {\n        var _condition$option2, _condition$option3;\n\n        // Check if answers include all options\n        return answer.length >= (condition === null || condition === void 0 ? void 0 : (_condition$option2 = condition.option) === null || _condition$option2 === void 0 ? void 0 : _condition$option2.length) && _.intersection(answer, condition === null || condition === void 0 ? void 0 : (_condition$option3 = condition.option) === null || _condition$option3 === void 0 ? void 0 : _condition$option3.map(o => o.value)).length === condition.option.length;\n      }\n    case 'exclude':\n      {\n        // TODO: add compare logics\n        return false;\n      }\n    case 'is':\n    default:\n      {\n        var _condition$option4, _condition$option5;\n\n        // Check if exactly match\n        return answer.length === (condition === null || condition === void 0 ? void 0 : (_condition$option4 = condition.option) === null || _condition$option4 === void 0 ? void 0 : _condition$option4.length) && _.difference(answer, condition === null || condition === void 0 ? void 0 : (_condition$option5 = condition.option) === null || _condition$option5 === void 0 ? void 0 : _condition$option5.map(o => o.value)).length === 0;\n      }\n  }\n}\n/**\n *  For loop all form conditions,\n *  and check if user answers matches any of those form conditions.\n *  If matched, return the matched form condition.\n *  Otherwise, return `null`\n *  @param {string[][]} userAnswers\n *  @param {import('./typedef').FormCondition[]} formConditions\n *  @return {import('./typedef').FormCondition}\n */\n\nfunction matchConditions(userAnswers, formConditions) {\n  let matchedFormCondition = null;\n  for (const fc of formConditions) {\n    let matches = [];\n    for (const c of fc.condition) {\n      const questionNo = c.formField.number;\n      matches.push(matchCondition(userAnswers[questionNo], c));\n    }\n    let matched = false;\n    if (fc.type === 'AND') {\n      matched = matches.indexOf(false) === -1;\n    }\n    /* cs.type === 'OR'*/else {\n      matched = matches.indexOf(true) > -1;\n    }\n    if (matched) {\n      matchedFormCondition = fc;\n      break;\n    }\n  }\n  return matchedFormCondition;\n}\n/**\n *  This function\n *  1. copies the form data object to avoid modifying the original one.\n *  2. sorts `questions` and `conditions` according to `sortOrder` and `order` properties.\n *  3. adds `number` property in `questions[]` and `conditons[].condition[].formField`\n *\n *  @param {import('./typedef').Form} form\n *  @return {import('./typedef').Form} new deep copy of form\n */\n\nfunction createFormData(form) {\n  const copyForm = _.cloneDeep(form); // sort question by sortOrder\n\n  copyForm.fields.sort((a, b) => {\n    return a.sortOrder - b.sortOrder;\n  }); // Raw question object has `id` and `sortOrder` properties.\n  // `id` is auto incremented by database;\n  // `sortOrder` is manually input by editors.\n  //  We need to handle the corner cases like\n  //  1. `sortOrder`s are identical\n  //  2. questions' order is not equal to `id`s' order\n  //  Therefore, we append the `number` property in each question.\n\n  applyQuestionNumber(copyForm.fields);\n  if (Array.isArray(copyForm === null || copyForm === void 0 ? void 0 : copyForm.conditions)) {\n    // sort conditions by order\n    copyForm.conditions.sort((a, b) => {\n      return a.order - b.order;\n    });\n    applyQuestionNumberInConditions(copyForm.conditions, copyForm.fields);\n  }\n  return copyForm;\n}\n/**\n *  Since we have multiple choice question, we use array to store answers of a question.\n *  Therefore, empty user answers are a two dimension array.\n *\n *  @param {number} questionNumber\n *  @return {string[][]}\n */\n\nfunction createEmptyUserAnswers(questionNumber) {\n  const rtn = [];\n  for (let i = 0; i < questionNumber; i++) {\n    rtn.push([]);\n  }\n  return rtn;\n}\n/**\n *  The raw form question objects does not contain `number` property.\n *  This function adds `number` property in each question according to the question order.\n *\n *  @param {import('./typedef').Question[]} questions\n */\n\nfunction applyQuestionNumber(questions) {\n  // append question number\n  for (let i = 0; i < questions.length; i++) {\n    const q = questions[i];\n    q.number = i;\n  }\n}\n/**\n *  This function adds `number` property into `formConditions[].condition[].formField`.\n *\n *  @param {import('./typedef').FormCondition[]} formConditions\n *  @param {import('./typedef').Question[]} questions\n */\n\nfunction applyQuestionNumberInConditions(formConditions, questions) {\n  for (const fc of formConditions) {\n    for (const c of fc.condition) {\n      if (c.formField) {\n        var _questions$find;\n        c.formField.number = (_questions$find = questions.find(q => q.id === c.formField.id)) === null || _questions$find === void 0 ? void 0 : _questions$find.number;\n      }\n    }\n  }\n}","map":{"version":3,"names":["Object","defineProperty","exports","value","default","Questionnaire","_question","_interopRequireDefault","require","_questionCard","_result","_react","_interopRequireWildcard","_cloneDeep","_difference","_intersection","_landing","_defaultLayout","_embeddedCode","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","cache","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_extends","assign","target","i","arguments","length","source","apply","_","cloneDeep","difference","intersection","_ref","form","enableDebugViewer","_userAnswers$currentQ","Array","isArray","fields","createElement","copyForm","useMemo","createFormData","emptyUserAnswers","createEmptyUserAnswers","userAnswers","setUserAnswers","useState","currentQuestion","setCurrentQuestion","currentFormCondition","setCurrentFormCondition","debugViewerJsx","style","position","right","top","height","overflow","id","JSON","stringify","number","matchedFormCondition","matchConditions","conditions","answer","next","goOut","_copyForm$answers","Fragment","resultData","answers","find","a","marginTop","EmbeddedCodeBlock","getData","caption","embeddedCode","feedback","name","nextQ","q","isFristPage","onAnswer","newUserAnswers","matchCondition","condition","compare","_condition$option","option","map","o","_condition$option2","_condition$option3","_condition$option4","_condition$option5","formConditions","fc","matches","c","questionNo","formField","push","matched","type","indexOf","sort","b","sortOrder","applyQuestionNumber","order","applyQuestionNumberInConditions","questionNumber","rtn","questions","_questions$find"],"sources":["/Users/mac/Documents/GitHub/deepfake-demo/node_modules/@readr-media/react-questionnaire/lib/react-components/index.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = Questionnaire;\n\nvar _question = _interopRequireDefault(require(\"./question\"));\n\nvar _questionCard = _interopRequireDefault(require(\"./question-card\"));\n\nvar _result = _interopRequireDefault(require(\"./result\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _cloneDeep = _interopRequireDefault(require(\"lodash/cloneDeep\"));\n\nvar _difference = _interopRequireDefault(require(\"lodash/difference\"));\n\nvar _intersection = _interopRequireDefault(require(\"lodash/intersection\"));\n\nvar _landing = _interopRequireDefault(require(\"./landing\"));\n\nvar _defaultLayout = _interopRequireDefault(require(\"./layout/default-layout\"));\n\nvar _embeddedCode = require(\"./draft/embedded-code\");\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nconst _ = {\n  cloneDeep: _cloneDeep.default,\n  difference: _difference.default,\n  intersection: _intersection.default\n};\n/**\n *  @param {Object} opts\n *  @param {import('./typedef').Form} opts.form\n *  @param {boolean} [opts.enableDebugViewer=false]\n *  @return {React.ReactElement}\n */\n\nfunction Questionnaire({\n  form,\n  enableDebugViewer = false\n}) {\n  var _userAnswers$currentQ;\n\n  if (!Array.isArray(form === null || form === void 0 ? void 0 : form.fields)) {\n    return /*#__PURE__*/_react.default.createElement(\"h3\", null, \"There is no question to answer\");\n  }\n\n  const copyForm = (0, _react.useMemo)(() => createFormData(form), [form]);\n  const emptyUserAnswers = (0, _react.useMemo)(() => createEmptyUserAnswers(copyForm.fields.length), [copyForm.fields.length]);\n  const [userAnswers, setUserAnswers] = (0, _react.useState)(emptyUserAnswers);\n  const [currentQuestion, setCurrentQuestion] = (0, _react.useState)(copyForm.fields[0]);\n  const [currentFormCondition, setCurrentFormCondition] = (0, _react.useState)(null);\n  let debugViewerJsx = null;\n\n  if (enableDebugViewer) {\n    debugViewerJsx = /*#__PURE__*/_react.default.createElement(\"div\", {\n      style: {\n        position: 'fixed',\n        right: '10px',\n        top: '30%',\n        height: '50vh',\n        overflow: 'scroll'\n      }\n    }, /*#__PURE__*/_react.default.createElement(\"pre\", {\n      id: \"json\"\n    }, currentFormCondition ? JSON.stringify(currentFormCondition, null, 4) : 'No form condition matched'));\n  } // The question has been answered\n\n\n  if (((_userAnswers$currentQ = userAnswers[currentQuestion.number]) === null || _userAnswers$currentQ === void 0 ? void 0 : _userAnswers$currentQ.length) > 0) {\n    const matchedFormCondition = matchConditions(userAnswers, copyForm.conditions);\n\n    if (matchedFormCondition) {\n      if (enableDebugViewer) {\n        if (matchedFormCondition.id !== (currentFormCondition === null || currentFormCondition === void 0 ? void 0 : currentFormCondition.id)) {\n          setCurrentFormCondition(matchedFormCondition);\n        }\n      }\n\n      const {\n        answer,\n        next,\n        goOut\n      } = matchedFormCondition;\n\n      if (answer) {\n        var _copyForm$answers;\n\n        return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, debugViewerJsx, /*#__PURE__*/_react.default.createElement(_result.default, {\n          resultData: (_copyForm$answers = copyForm.answers) === null || _copyForm$answers === void 0 ? void 0 : _copyForm$answers.find(a => a.id === answer.id)\n        }), /*#__PURE__*/_react.default.createElement(\"div\", {\n          style: {\n            marginTop: '60px'\n          }\n        }, /*#__PURE__*/_react.default.createElement(_embeddedCode.EmbeddedCodeBlock, {\n          getData: () => {\n            return {\n              caption: '',\n              embeddedCode: (form === null || form === void 0 ? void 0 : form.feedback) || ''\n            };\n          }\n        })));\n      }\n\n      if (goOut) {\n        // TODO: render GoOut component\n        return /*#__PURE__*/_react.default.createElement(\"div\", null, \"render goOut component\");\n      }\n\n      if (!next) {\n        // The program should not enter this condition.\n        // If it does, then the form data is created wrongly.\n        return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, debugViewerJsx, /*#__PURE__*/_react.default.createElement(_result.default, {\n          resultData: {\n            name: `Next question is not specified`\n          }\n        }));\n      }\n\n      const nextQ = copyForm.fields.find(q => q.id === next.id);\n\n      if (nextQ.id === currentQuestion.id) {\n        return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, debugViewerJsx, /*#__PURE__*/_react.default.createElement(_result.default, {\n          resultData: {\n            name: `Next question is not configured right. The next question name is ${nextQ.name}`\n          }\n        }));\n      } // Go to next queustion\n\n\n      setCurrentQuestion(nextQ);\n    } else {\n      return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, debugViewerJsx, /*#__PURE__*/_react.default.createElement(_result.default, {\n        resultData: {\n          name: 'There is no matched condition'\n        }\n      }));\n    }\n  }\n\n  return /*#__PURE__*/_react.default.createElement(_defaultLayout.default, null, debugViewerJsx, /*#__PURE__*/_react.default.createElement(_landing.default, {\n    form: form\n  }), /*#__PURE__*/_react.default.createElement(_questionCard.default, {\n    isFristPage: userAnswers[0].length === 0\n  }, /*#__PURE__*/_react.default.createElement(_question.default, _extends({\n    key: currentQuestion.id\n  }, currentQuestion, {\n    onAnswer:\n    /**\n     *  @param {string[]} a\n     */\n    a => {\n      const newUserAnswers = [...userAnswers];\n      newUserAnswers[currentQuestion.number] = a;\n      setUserAnswers(newUserAnswers);\n    }\n  }))));\n}\n/**\n *  The function compares the `condition` and `answer` objects.\n *  If `answer` matches `condition`, return true, otherwise, return false.\n *\n *  @param {string[]} answer\n *  @param {import('./typedef').Condition} condition\n *  @return {boolean}\n */\n\n\nfunction matchCondition(answer, condition) {\n  // no answer\n  if (answer.length === 0) {\n    return false;\n  }\n\n  switch (condition.compare) {\n    case 'not':\n      {\n        var _condition$option;\n\n        // Check if there is no any answer to match any option\n        return _.intersection(answer, condition === null || condition === void 0 ? void 0 : (_condition$option = condition.option) === null || _condition$option === void 0 ? void 0 : _condition$option.map(o => o.value)).length === 0;\n      }\n\n    case 'include':\n      {\n        var _condition$option2, _condition$option3;\n\n        // Check if answers include all options\n        return answer.length >= (condition === null || condition === void 0 ? void 0 : (_condition$option2 = condition.option) === null || _condition$option2 === void 0 ? void 0 : _condition$option2.length) && _.intersection(answer, condition === null || condition === void 0 ? void 0 : (_condition$option3 = condition.option) === null || _condition$option3 === void 0 ? void 0 : _condition$option3.map(o => o.value)).length === condition.option.length;\n      }\n\n    case 'exclude':\n      {\n        // TODO: add compare logics\n        return false;\n      }\n\n    case 'is':\n    default:\n      {\n        var _condition$option4, _condition$option5;\n\n        // Check if exactly match\n        return answer.length === (condition === null || condition === void 0 ? void 0 : (_condition$option4 = condition.option) === null || _condition$option4 === void 0 ? void 0 : _condition$option4.length) && _.difference(answer, condition === null || condition === void 0 ? void 0 : (_condition$option5 = condition.option) === null || _condition$option5 === void 0 ? void 0 : _condition$option5.map(o => o.value)).length === 0;\n      }\n  }\n}\n/**\n *  For loop all form conditions,\n *  and check if user answers matches any of those form conditions.\n *  If matched, return the matched form condition.\n *  Otherwise, return `null`\n *  @param {string[][]} userAnswers\n *  @param {import('./typedef').FormCondition[]} formConditions\n *  @return {import('./typedef').FormCondition}\n */\n\n\nfunction matchConditions(userAnswers, formConditions) {\n  let matchedFormCondition = null;\n\n  for (const fc of formConditions) {\n    let matches = [];\n\n    for (const c of fc.condition) {\n      const questionNo = c.formField.number;\n      matches.push(matchCondition(userAnswers[questionNo], c));\n    }\n\n    let matched = false;\n\n    if (fc.type === 'AND') {\n      matched = matches.indexOf(false) === -1;\n    }\n    /* cs.type === 'OR'*/\n    else {\n      matched = matches.indexOf(true) > -1;\n    }\n\n    if (matched) {\n      matchedFormCondition = fc;\n      break;\n    }\n  }\n\n  return matchedFormCondition;\n}\n/**\n *  This function\n *  1. copies the form data object to avoid modifying the original one.\n *  2. sorts `questions` and `conditions` according to `sortOrder` and `order` properties.\n *  3. adds `number` property in `questions[]` and `conditons[].condition[].formField`\n *\n *  @param {import('./typedef').Form} form\n *  @return {import('./typedef').Form} new deep copy of form\n */\n\n\nfunction createFormData(form) {\n  const copyForm = _.cloneDeep(form); // sort question by sortOrder\n\n\n  copyForm.fields.sort((a, b) => {\n    return a.sortOrder - b.sortOrder;\n  }); // Raw question object has `id` and `sortOrder` properties.\n  // `id` is auto incremented by database;\n  // `sortOrder` is manually input by editors.\n  //  We need to handle the corner cases like\n  //  1. `sortOrder`s are identical\n  //  2. questions' order is not equal to `id`s' order\n  //  Therefore, we append the `number` property in each question.\n\n  applyQuestionNumber(copyForm.fields);\n\n  if (Array.isArray(copyForm === null || copyForm === void 0 ? void 0 : copyForm.conditions)) {\n    // sort conditions by order\n    copyForm.conditions.sort((a, b) => {\n      return a.order - b.order;\n    });\n    applyQuestionNumberInConditions(copyForm.conditions, copyForm.fields);\n  }\n\n  return copyForm;\n}\n/**\n *  Since we have multiple choice question, we use array to store answers of a question.\n *  Therefore, empty user answers are a two dimension array.\n *\n *  @param {number} questionNumber\n *  @return {string[][]}\n */\n\n\nfunction createEmptyUserAnswers(questionNumber) {\n  const rtn = [];\n\n  for (let i = 0; i < questionNumber; i++) {\n    rtn.push([]);\n  }\n\n  return rtn;\n}\n/**\n *  The raw form question objects does not contain `number` property.\n *  This function adds `number` property in each question according to the question order.\n *\n *  @param {import('./typedef').Question[]} questions\n */\n\n\nfunction applyQuestionNumber(questions) {\n  // append question number\n  for (let i = 0; i < questions.length; i++) {\n    const q = questions[i];\n    q.number = i;\n  }\n}\n/**\n *  This function adds `number` property into `formConditions[].condition[].formField`.\n *\n *  @param {import('./typedef').FormCondition[]} formConditions\n *  @param {import('./typedef').Question[]} questions\n */\n\n\nfunction applyQuestionNumberInConditions(formConditions, questions) {\n  for (const fc of formConditions) {\n    for (const c of fc.condition) {\n      if (c.formField) {\n        var _questions$find;\n\n        c.formField.number = (_questions$find = questions.find(q => q.id === c.formField.id)) === null || _questions$find === void 0 ? void 0 : _questions$find.number;\n      }\n    }\n  }\n}"],"mappings":"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"},"metadata":{},"sourceType":"script"}