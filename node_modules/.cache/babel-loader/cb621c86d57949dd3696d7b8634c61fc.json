{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Documents/GitHub/deepfake-demo/src/generator/index.js\";\n/* eslint no-console: 0 */\n\nimport React from 'react'; // eslint-disable-line\nimport ReactDOMServer from 'react-dom/server';\nimport get from 'lodash/get.js';\nimport map from 'lodash/map';\nimport serialize from 'serialize-javascript';\nimport VisualAnimation from '@readr-media/visual-animation';\nimport { ServerStyleSheet } from 'styled-components';\nimport { v4 as uuidv4 } from 'uuid';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst _ = {\n  get,\n  map\n};\n\n//動畫\nexport function buildAnimationEmbedCode() {\n  return buildEmbeddedCode('visual-animation', {}, {});\n}\n\n/**\n *\n * @export\n * @param {('react-questionnaire'|'react-qa-list'|\n * 'react-feedback'|'react-karaoke'|'react-live-blog'|\n * 'react-election-widgets-seat-chart'|\n * 'react-election-widgets-votes-comparison'|\n * 'react-three-story-points' | 'react-full-screen-video' |\n * 'react-dual-slides' | 'react-random-text-selector' | 'react-dropping-text'| 'visual-animation ')} pkgName\n * @param {Object} data - Data for react component\n * @param {Object} webpackAssets - webpack bundles and chunks\n * @param {string[]} webpackAssets.entrypoints - webpack bundles\n * @param {string} webpackAssets.version - webpack bundles version\n * @returns {string} embedded code\n */\nexport function buildEmbeddedCode(pkgName, data, webpackAssets) {\n  // use uuid to avoid duplication id\n  const uuid = uuidv4();\n  const dataWithUuid = {\n    ...data,\n    uuid\n  };\n  const {\n    entrypoints: bundles\n  } = webpackAssets;\n  let Component = null;\n  let skipServerSideRendering = false;\n  switch (pkgName) {\n    case 'visual-animation':\n      Component = VisualAnimation;\n      break;\n    default:\n      throw new Error(`pkgName ${pkgName} is not supported`);\n  }\n  let jsx = `<div id=\"${uuid}\"></div>`;\n  let styleTags = '';\n  if (!skipServerSideRendering) {\n    const sheet = new ServerStyleSheet();\n    try {\n      jsx = ReactDOMServer.renderToStaticMarkup(sheet.collectStyles( /*#__PURE__*/_jsxDEV(\"div\", {\n        id: uuid,\n        children: /*#__PURE__*/_jsxDEV(Component, {\n          ...data\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 11\n      }, this)));\n      styleTags = sheet.getStyleTags();\n    } catch (err) {\n      throw err;\n    } finally {\n      sheet.seal();\n    }\n  }\n  return `\n    ${styleTags}\n    <script>\n      (function() {\n        var namespace = '@readr-media';\n        var pkg = '${pkgName}@${webpackAssets.version}';\n        if (typeof window != 'undefined') {\n          if (!window.hasOwnProperty(namespace)) {\n            window[namespace] = {};\n          }\n          if (window[namespace] && !window[namespace].hasOwnProperty(pkg)) {\n            window[namespace][pkg] = [];\n          }\n          if (Array.isArray(window[namespace][pkg])) {\n            var data = ${serialize(dataWithUuid)};\n            window[namespace][pkg].push(data);\n          }\n        }\n      })()\n    </script>\n    ${jsx}\n    ${_.map(bundles, bundle => {\n    return `<script type=\"text/javascript\" defer crossorigin src=\"${bundle}\"></script>`;\n  }).join('')}\n  `;\n}","map":{"version":3,"names":["React","ReactDOMServer","get","map","serialize","VisualAnimation","ServerStyleSheet","v4","uuidv4","jsxDEV","_jsxDEV","_","buildAnimationEmbedCode","buildEmbeddedCode","pkgName","data","webpackAssets","uuid","dataWithUuid","entrypoints","bundles","Component","skipServerSideRendering","Error","jsx","styleTags","sheet","renderToStaticMarkup","collectStyles","id","children","fileName","_jsxFileName","lineNumber","columnNumber","getStyleTags","err","seal","version","bundle","join"],"sources":["/Users/mac/Documents/GitHub/deepfake-demo/src/generator/index.js"],"sourcesContent":["/* eslint no-console: 0 */\n\nimport React from 'react'; // eslint-disable-line\nimport ReactDOMServer from 'react-dom/server';\n\nimport get from 'lodash/get.js';\nimport map from 'lodash/map';\nimport serialize from 'serialize-javascript';\nimport VisualAnimation from '@readr-media/visual-animation';\nimport { ServerStyleSheet } from 'styled-components';\nimport { v4 as uuidv4 } from 'uuid';\n\nconst _ = {\n  get,\n  map,\n};\n\n//動畫\nexport function buildAnimationEmbedCode() {\n  return buildEmbeddedCode('visual-animation', {}, {});\n}\n\n/**\n *\n * @export\n * @param {('react-questionnaire'|'react-qa-list'|\n * 'react-feedback'|'react-karaoke'|'react-live-blog'|\n * 'react-election-widgets-seat-chart'|\n * 'react-election-widgets-votes-comparison'|\n * 'react-three-story-points' | 'react-full-screen-video' |\n * 'react-dual-slides' | 'react-random-text-selector' | 'react-dropping-text'| 'visual-animation ')} pkgName\n * @param {Object} data - Data for react component\n * @param {Object} webpackAssets - webpack bundles and chunks\n * @param {string[]} webpackAssets.entrypoints - webpack bundles\n * @param {string} webpackAssets.version - webpack bundles version\n * @returns {string} embedded code\n */\nexport function buildEmbeddedCode(pkgName, data, webpackAssets) {\n  // use uuid to avoid duplication id\n  const uuid = uuidv4();\n  const dataWithUuid = {\n    ...data,\n    uuid,\n  };\n\n  const { entrypoints: bundles } = webpackAssets;\n\n  let Component = null;\n  let skipServerSideRendering = false;\n  switch (pkgName) {\n    case 'visual-animation':\n      Component = VisualAnimation;\n      break;\n    default:\n      throw new Error(`pkgName ${pkgName} is not supported`);\n  }\n\n  let jsx = `<div id=\"${uuid}\"></div>`;\n  let styleTags = '';\n\n  if (!skipServerSideRendering) {\n    const sheet = new ServerStyleSheet();\n    try {\n      jsx = ReactDOMServer.renderToStaticMarkup(\n        sheet.collectStyles(\n          <div id={uuid}>\n            <Component {...data} />\n          </div>\n        )\n      );\n      styleTags = sheet.getStyleTags();\n    } catch (err) {\n      throw err;\n    } finally {\n      sheet.seal();\n    }\n  }\n\n  return `\n    ${styleTags}\n    <script>\n      (function() {\n        var namespace = '@readr-media';\n        var pkg = '${pkgName}@${webpackAssets.version}';\n        if (typeof window != 'undefined') {\n          if (!window.hasOwnProperty(namespace)) {\n            window[namespace] = {};\n          }\n          if (window[namespace] && !window[namespace].hasOwnProperty(pkg)) {\n            window[namespace][pkg] = [];\n          }\n          if (Array.isArray(window[namespace][pkg])) {\n            var data = ${serialize(dataWithUuid)};\n            window[namespace][pkg].push(data);\n          }\n        }\n      })()\n    </script>\n    ${jsx}\n    ${_.map(bundles, (bundle) => {\n      return `<script type=\"text/javascript\" defer crossorigin src=\"${bundle}\"></script>`;\n    }).join('')}\n  `;\n}\n"],"mappings":";AAAA;;AAEA,OAAOA,KAAK,MAAM,OAAO,CAAC,CAAC;AAC3B,OAAOC,cAAc,MAAM,kBAAkB;AAE7C,OAAOC,GAAG,MAAM,eAAe;AAC/B,OAAOC,GAAG,MAAM,YAAY;AAC5B,OAAOC,SAAS,MAAM,sBAAsB;AAC5C,OAAOC,eAAe,MAAM,+BAA+B;AAC3D,SAASC,gBAAgB,QAAQ,mBAAmB;AACpD,SAASC,EAAE,IAAIC,MAAM,QAAQ,MAAM;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEpC,MAAMC,CAAC,GAAG;EACRT,GAAG;EACHC;AACF,CAAC;;AAED;AACA,OAAO,SAASS,uBAAuBA,CAAA,EAAG;EACxC,OAAOC,iBAAiB,CAAC,kBAAkB,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AACtD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASA,iBAAiBA,CAACC,OAAO,EAAEC,IAAI,EAAEC,aAAa,EAAE;EAC9D;EACA,MAAMC,IAAI,GAAGT,MAAM,CAAC,CAAC;EACrB,MAAMU,YAAY,GAAG;IACnB,GAAGH,IAAI;IACPE;EACF,CAAC;EAED,MAAM;IAAEE,WAAW,EAAEC;EAAQ,CAAC,GAAGJ,aAAa;EAE9C,IAAIK,SAAS,GAAG,IAAI;EACpB,IAAIC,uBAAuB,GAAG,KAAK;EACnC,QAAQR,OAAO;IACb,KAAK,kBAAkB;MACrBO,SAAS,GAAGhB,eAAe;MAC3B;IACF;MACE,MAAM,IAAIkB,KAAK,CAAE,WAAUT,OAAQ,mBAAkB,CAAC;EAC1D;EAEA,IAAIU,GAAG,GAAI,YAAWP,IAAK,UAAS;EACpC,IAAIQ,SAAS,GAAG,EAAE;EAElB,IAAI,CAACH,uBAAuB,EAAE;IAC5B,MAAMI,KAAK,GAAG,IAAIpB,gBAAgB,CAAC,CAAC;IACpC,IAAI;MACFkB,GAAG,GAAGvB,cAAc,CAAC0B,oBAAoB,CACvCD,KAAK,CAACE,aAAa,eACjBlB,OAAA;QAAKmB,EAAE,EAAEZ,IAAK;QAAAa,QAAA,eACZpB,OAAA,CAACW,SAAS;UAAA,GAAKN;QAAI;UAAAgB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACpB,CACP,CACF,CAAC;MACDT,SAAS,GAAGC,KAAK,CAACS,YAAY,CAAC,CAAC;IAClC,CAAC,CAAC,OAAOC,GAAG,EAAE;MACZ,MAAMA,GAAG;IACX,CAAC,SAAS;MACRV,KAAK,CAACW,IAAI,CAAC,CAAC;IACd;EACF;EAEA,OAAQ;AACV,MAAMZ,SAAU;AAChB;AACA;AACA;AACA,qBAAqBX,OAAQ,IAAGE,aAAa,CAACsB,OAAQ;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyBlC,SAAS,CAACc,YAAY,CAAE;AACjD;AACA;AACA;AACA;AACA;AACA,MAAMM,GAAI;AACV,MAAMb,CAAC,CAACR,GAAG,CAACiB,OAAO,EAAGmB,MAAM,IAAK;IAC3B,OAAQ,yDAAwDA,MAAO,aAAY;EACrF,CAAC,CAAC,CAACC,IAAI,CAAC,EAAE,CAAE;AAChB,GAAG;AACH"},"metadata":{},"sourceType":"module"}