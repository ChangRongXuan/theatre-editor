{"ast":null,"code":"import _objectSpread from\"/Users/mac/Documents/GitHub/deepfake-demo/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/mac/Documents/GitHub/deepfake-demo/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/Users/mac/Documents/GitHub/deepfake-demo/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject;import studio from'@theatre/studio';import{types}from'@theatre/core';import{useState,useEffect}from'react';import Stage from'../components/stage';import{initialConfig}from'../constants';import styled from'styled-components';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var CopyEmbedded=styled.button(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  position: fixed;\\n  bottom: 20px;\\n  left: 20px;\\n  cursor: pointer;\\n\"])));export default function DemoVideo(_ref){var project=_ref.project,sheet=_ref.sheet;studio.ui.hide();project.ready.then(function(){return sheet.sequence.play({iterationCount:Infinity});});var _useState=useState([]),_useState2=_slicedToArray(_useState,2),savedData=_useState2[0],setSavedData=_useState2[1];useEffect(function(){var elements=localStorage.getItem('theatre-data');if(elements){setSavedData(JSON.parse(elements));}},[]);useEffect(function(){if(savedData.length>0){//render font control menu\nsavedData.filter(function(item){return item.type==='font';}).forEach(function(item){var menuConfig=sheet.object(item.id,_objectSpread(_objectSpread({},initialConfig.FONT),{},{content:types.string(\"\".concat(item.content))}));var element=document.getElementById(item.id);menuConfig.onValuesChange(function(newValue){element.style.left=newValue.position.x+'%';element.style.top=newValue.position.y+'%';element.style.background=newValue.bgColor;element.style.color=newValue.font.color;element.style.opacity=newValue.opacity;element.style.padding=newValue.padding+'px';element.style.display=newValue.visible?'block':'none';element.style.width=newValue.size.width+'px';element.style.height=newValue.size.height+'px';element.style.fontSize=newValue.font.size+'px';element.style.borderRadius=newValue.border.radius+'%';element.style.border=\"\".concat(newValue.border.size,\"px solid \").concat(newValue.border.color);});});}},[savedData]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Stage,{savedData:savedData,sheet:sheet})});}","map":{"version":3,"names":["studio","types","useState","useEffect","Stage","initialConfig","styled","jsx","_jsx","Fragment","_Fragment","CopyEmbedded","button","_templateObject","_taggedTemplateLiteral","DemoVideo","_ref","project","sheet","ui","hide","ready","then","sequence","play","iterationCount","Infinity","_useState","_useState2","_slicedToArray","savedData","setSavedData","elements","localStorage","getItem","JSON","parse","length","filter","item","type","forEach","menuConfig","object","id","_objectSpread","FONT","content","string","concat","element","document","getElementById","onValuesChange","newValue","style","left","position","x","top","y","background","bgColor","color","font","opacity","padding","display","visible","width","size","height","fontSize","borderRadius","border","radius","children"],"sources":["/Users/mac/Documents/GitHub/deepfake-demo/src/page/demo-video.js"],"sourcesContent":["import studio from '@theatre/studio';\nimport { types } from '@theatre/core';\nimport { useState, useEffect } from 'react';\nimport Stage from '../components/stage';\nimport { initialConfig } from '../constants';\nimport styled from 'styled-components';\n\nconst CopyEmbedded = styled.button`\n  position: fixed;\n  bottom: 20px;\n  left: 20px;\n  cursor: pointer;\n`;\n\nexport default function DemoVideo({ project, sheet }) {\n  studio.ui.hide();\n  project.ready.then(() =>\n    sheet.sequence.play({\n      iterationCount: Infinity,\n    })\n  );\n\n  const [savedData, setSavedData] = useState([]);\n\n  useEffect(() => {\n    const elements = localStorage.getItem('theatre-data');\n    if (elements) {\n      setSavedData(JSON.parse(elements));\n    }\n  }, []);\n\n  useEffect(() => {\n    if (savedData.length > 0) {\n      //render font control menu\n      savedData\n        .filter((item) => item.type === 'font')\n        .forEach((item) => {\n          const menuConfig = sheet.object(item.id, {\n            ...initialConfig.FONT,\n            content: types.string(`${item.content}`),\n          });\n          const element = document.getElementById(item.id);\n\n          menuConfig.onValuesChange((newValue) => {\n            element.style.left = newValue.position.x + '%';\n            element.style.top = newValue.position.y + '%';\n            element.style.background = newValue.bgColor;\n            element.style.color = newValue.font.color;\n            element.style.opacity = newValue.opacity;\n            element.style.padding = newValue.padding + 'px';\n            element.style.display = newValue.visible ? 'block' : 'none';\n            element.style.width = newValue.size.width + 'px';\n            element.style.height = newValue.size.height + 'px';\n            element.style.fontSize = newValue.font.size + 'px';\n            element.style.borderRadius = newValue.border.radius + '%';\n            element.style.border = `${newValue.border.size}px solid ${newValue.border.color}`;\n          });\n        });\n    }\n  }, [savedData]);\n\n  return (\n    <>\n      <Stage savedData={savedData} sheet={sheet} />\n      {/* <CopyEmbedded\n        onClick={() => {\n          alert('已複製 EmbeddedCode');\n        }}\n      >\n        Copy Embedded\n      </CopyEmbedded> */}\n    </>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}