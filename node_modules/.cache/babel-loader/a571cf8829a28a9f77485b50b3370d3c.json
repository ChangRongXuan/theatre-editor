{"ast":null,"code":"import _slicedToArray from\"/Users/mac/Documents/GitHub/deepfake-demo/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/Users/mac/Documents/GitHub/deepfake-demo/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject;import studio from'@theatre/studio';import{getProject}from'@theatre/core';import Stage from'../components/stage';import Dimmer from'../components/dimmer-with-message';import{useState,useEffect}from'react';import styled from'styled-components';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var VideoWrapper=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  width: 100vw;\\n  height: 100vh;\\n\"])));export default function DemoVideo(){studio.initialize();studio.ui.hide();var project=getProject('Project',{});var sheet=project.sheet('Scene','default');project.ready.then(function(){return sheet.sequence.play({iterationCount:Infinity});});var objJson=localStorage.getItem('theatre-data');// get objectJSON in local-storage\nvar objData=objJson?JSON.parse(objJson):[];// --------------------------\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),hasMediaError=_useState2[0],setHasMediaError=_useState2[1];// image & background && video onError\nvar _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),loadedMedias=_useState4[0],setLoadedMedias=_useState4[1];// image & background && video onload\nvar _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var totalMedias=objData.filter(function(data){return data.type==='IMAGE'||data.type==='BACKGROUND';}).length;useEffect(function(){if(loadedMedias===totalMedias){setIsLoading(false);}},[loadedMedias,totalMedias]);return/*#__PURE__*/_jsxs(VideoWrapper,{children:[/*#__PURE__*/_jsx(Dimmer,{show:isLoading&&!hasMediaError,message:'載入中',shining:true}),/*#__PURE__*/_jsx(Dimmer,{show:hasMediaError,message:'載入失敗。請檢查您的網路連線，並重新整理瀏覽器。'}),/*#__PURE__*/_jsx(Stage,{objData:objData,sheet:sheet,stageWidth:window.innerWidth,draggable:false,setHasMediaError:setHasMediaError,setLoadedMedias:setLoadedMedias})]});}","map":{"version":3,"names":["studio","getProject","Stage","Dimmer","useState","useEffect","styled","jsx","_jsx","jsxs","_jsxs","VideoWrapper","div","_templateObject","_taggedTemplateLiteral","DemoVideo","initialize","ui","hide","project","sheet","ready","then","sequence","play","iterationCount","Infinity","objJson","localStorage","getItem","objData","JSON","parse","_useState","_useState2","_slicedToArray","hasMediaError","setHasMediaError","_useState3","_useState4","loadedMedias","setLoadedMedias","_useState5","_useState6","isLoading","setIsLoading","totalMedias","filter","data","type","length","children","show","message","shining","stageWidth","window","innerWidth","draggable"],"sources":["/Users/mac/Documents/GitHub/deepfake-demo/src/page/demo-video.js"],"sourcesContent":["import studio from '@theatre/studio';\nimport { getProject } from '@theatre/core';\nimport Stage from '../components/stage';\nimport Dimmer from '../components/dimmer-with-message';\nimport { useState, useEffect } from 'react';\nimport styled from 'styled-components';\n\nconst VideoWrapper = styled.div`\n  width: 100vw;\n  height: 100vh;\n`;\n\nexport default function DemoVideo() {\n  studio.initialize();\n  studio.ui.hide();\n  const project = getProject('Project', {});\n  const sheet = project.sheet('Scene', 'default');\n\n  project.ready.then(() =>\n    sheet.sequence.play({\n      iterationCount: Infinity,\n    })\n  );\n\n  const objJson = localStorage.getItem('theatre-data'); // get objectJSON in local-storage\n  const objData = objJson ? JSON.parse(objJson) : [];\n\n  // --------------------------\n\n  const [hasMediaError, setHasMediaError] = useState(false); // image & background && video onError\n  const [loadedMedias, setLoadedMedias] = useState(0); // image & background && video onload\n  const [isLoading, setIsLoading] = useState(true);\n\n  const totalMedias = objData.filter(\n    (data) => data.type === 'IMAGE' || data.type === 'BACKGROUND'\n  ).length;\n\n  useEffect(() => {\n    if (loadedMedias === totalMedias) {\n      setIsLoading(false);\n    }\n  }, [loadedMedias, totalMedias]);\n\n  return (\n    <VideoWrapper>\n      <Dimmer\n        show={isLoading && !hasMediaError}\n        message={'載入中'}\n        shining={true}\n      />\n      <Dimmer\n        show={hasMediaError}\n        message={'載入失敗。請檢查您的網路連線，並重新整理瀏覽器。'}\n      />\n      <Stage\n        objData={objData}\n        sheet={sheet}\n        stageWidth={window.innerWidth}\n        draggable={false}\n        setHasMediaError={setHasMediaError}\n        setLoadedMedias={setLoadedMedias}\n      />\n    </VideoWrapper>\n  );\n}\n"],"mappings":"kSAAA,MAAO,CAAAA,MAAM,KAAM,iBAAiB,CACpC,OAASC,UAAU,KAAQ,eAAe,CAC1C,MAAO,CAAAC,KAAK,KAAM,qBAAqB,CACvC,MAAO,CAAAC,MAAM,KAAM,mCAAmC,CACtD,OAASC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,MAAO,CAAAC,MAAM,KAAM,mBAAmB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAEvC,GAAM,CAAAC,YAAY,CAAGL,MAAM,CAACM,GAAG,CAAAC,eAAA,GAAAA,eAAA,CAAAC,sBAAA,6CAG9B,CAED,cAAe,SAAS,CAAAC,SAASA,CAAA,CAAG,CAClCf,MAAM,CAACgB,UAAU,CAAC,CAAC,CACnBhB,MAAM,CAACiB,EAAE,CAACC,IAAI,CAAC,CAAC,CAChB,GAAM,CAAAC,OAAO,CAAGlB,UAAU,CAAC,SAAS,CAAE,CAAC,CAAC,CAAC,CACzC,GAAM,CAAAmB,KAAK,CAAGD,OAAO,CAACC,KAAK,CAAC,OAAO,CAAE,SAAS,CAAC,CAE/CD,OAAO,CAACE,KAAK,CAACC,IAAI,CAAC,iBACjB,CAAAF,KAAK,CAACG,QAAQ,CAACC,IAAI,CAAC,CAClBC,cAAc,CAAEC,QAClB,CAAC,CAAC,EACJ,CAAC,CAED,GAAM,CAAAC,OAAO,CAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC,CAAE;AACtD,GAAM,CAAAC,OAAO,CAAGH,OAAO,CAAGI,IAAI,CAACC,KAAK,CAACL,OAAO,CAAC,CAAG,EAAE,CAElD;AAEA,IAAAM,SAAA,CAA0C7B,QAAQ,CAAC,KAAK,CAAC,CAAA8B,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAAlDG,aAAa,CAAAF,UAAA,IAAEG,gBAAgB,CAAAH,UAAA,IAAqB;AAC3D,IAAAI,UAAA,CAAwClC,QAAQ,CAAC,CAAC,CAAC,CAAAmC,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAA5CE,YAAY,CAAAD,UAAA,IAAEE,eAAe,CAAAF,UAAA,IAAiB;AACrD,IAAAG,UAAA,CAAkCtC,QAAQ,CAAC,IAAI,CAAC,CAAAuC,UAAA,CAAAR,cAAA,CAAAO,UAAA,IAAzCE,SAAS,CAAAD,UAAA,IAAEE,YAAY,CAAAF,UAAA,IAE9B,GAAM,CAAAG,WAAW,CAAGhB,OAAO,CAACiB,MAAM,CAChC,SAACC,IAAI,QAAK,CAAAA,IAAI,CAACC,IAAI,GAAK,OAAO,EAAID,IAAI,CAACC,IAAI,GAAK,YAAY,EAC/D,CAAC,CAACC,MAAM,CAER7C,SAAS,CAAC,UAAM,CACd,GAAImC,YAAY,GAAKM,WAAW,CAAE,CAChCD,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CAAC,CAAE,CAACL,YAAY,CAAEM,WAAW,CAAC,CAAC,CAE/B,mBACEpC,KAAA,CAACC,YAAY,EAAAwC,QAAA,eACX3C,IAAA,CAACL,MAAM,EACLiD,IAAI,CAAER,SAAS,EAAI,CAACR,aAAc,CAClCiB,OAAO,CAAE,KAAM,CACfC,OAAO,CAAE,IAAK,CACf,CAAC,cACF9C,IAAA,CAACL,MAAM,EACLiD,IAAI,CAAEhB,aAAc,CACpBiB,OAAO,CAAE,0BAA2B,CACrC,CAAC,cACF7C,IAAA,CAACN,KAAK,EACJ4B,OAAO,CAAEA,OAAQ,CACjBV,KAAK,CAAEA,KAAM,CACbmC,UAAU,CAAEC,MAAM,CAACC,UAAW,CAC9BC,SAAS,CAAE,KAAM,CACjBrB,gBAAgB,CAAEA,gBAAiB,CACnCI,eAAe,CAAEA,eAAgB,CAClC,CAAC,EACU,CAAC,CAEnB"},"metadata":{},"sourceType":"module"}